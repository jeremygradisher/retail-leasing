<% if (current_user && current_user.is_admin?) || (current_user && (current_user.project_ids.include? @area.project_id)) %>
<%- model_class = Area -%>
<div class="page-header" style="margin: 20px 0 20px;">
  <h1 style="float:left;"><%=t '.title', :default => model_class.model_name.human.titleize %>: <%= @area.suite_number %></h1>
<% if (current_user && current_user.is_admin?) || (current_user && current_user.role == 'Admin' && (current_user.project_ids.include? @area.project_id)) || (current_user && current_user.role == 'Editor' && (current_user.project_ids.include? @area.project_id)) %>

  <%= link_to '+ Associate Area/Deal', new_areas_deal_path(:project_id => @project),
                    :class => 'btn btn-primary print-none',
                    :style => 'float:right;margin-top:20px;margin-right:10px;color:#fff;background-color:#16A3BA;border-color:#16A3BA;' %>
<% end %>
  <br style="clear:both;">
</div>

<div class="row">
  <div class="col-xs-10 col-xs-offset-1">
    <%= render 'areamap' %>
  </div>
</div>

<br>
<hr>

<dl class="dl-horizontal">
  <dt><strong><%= model_class.human_attribute_name(:suite_number) %>:</strong></dt>
  <dd><%= @area.suite_number %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:associated_deals) %>:</strong></dt>
  <dd><%= @area.areas_deals.count %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:deal_titles) %>:</strong></dt>
  <dd>
      <% if @area.deals.count > 0 %>
        <% @area.deals.each do |deal| %>
          <%= link_to deal.deal_name, deal %> <%#= AreasDeal.where(deal_id: deal, area_id: @area).ids %> 
          <% if current_user.is_admin? || current_user.role == 'Admin' || current_user.role == 'Editor' %>
          <%= link_to '<i class="fa fa-minus-square"></i>'.html_safe,
                      areas_deal_path(AreasDeal.where(deal_id: deal, area_id: @area).ids),
                      :method => :delete,
                      :title => 'Remove Association',
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => '/*btn btn-danger*/' %>
          <% end %><br>
        <% end %>
      <% else %>There are no deals associated.<% end %>
  </dd>
  
  <% if current_user.is_admin? || current_user.role == 'Admin' || current_user.role == 'Editor' %>
  <br>
  <%= render :partial => 'add_deal_association' %>
  <% end %>
  
  <dt><strong><%= model_class.human_attribute_name(:deal_image) %>:</strong></dt>
  <dd>
    <% if @area.deals.count > 0 %>
      <% if @area.deals.first.dealimages.blank? %>
        <%= link_to image_tag('/images/status-plan-logo.png', :style => 'width:300px !important;float:left;margin-top:20px;margin-bottom:20px;'), deal_path(@area.deals.first) %>
      <% else %>
        <%= link_to image_tag(@area.deals.first.dealimages.first.dealimage_url, :style => 'width:300px !important;float:left;'), deal_path(@area.deals.first) %>
      <% end %>
    <% end %>
  </dd>
  
  <dt><strong><%= model_class.human_attribute_name(:area_sqft) %>:</strong></dt>
  <dd><%= number_with_delimiter(@area.area_sqft, :delimiter => ',') %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:map_id) %>:</strong></dt>
  <dd><%= @area.map_id %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:project_id) %>:</strong></dt>
  <dd><%= @area.project_id %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:status) %>:</strong></dt>
  <dd><%= @area.status %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:coords) %>:</strong></dt>
  <dd><%= @area.coords %></dd>
</dl>

<%= link_to "<= Project",
              project_path(@area.project_id), :class => 'btn btn-default'  %>
<% if (current_user && current_user.is_admin?) || (current_user && current_user.role == 'Admin' && (current_user.project_ids.include? @area.project_id)) || (current_user && current_user.role == 'Editor' && (current_user.project_ids.include? @area.project_id)) %>

<%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_area_path(@area), :class => 'btn btn-primary' %>
<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              area_path(@area),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
<% end %>              
              
<% else %>
 <h2>You are not authorized to be here. <a href="/" class="btn btn-default">Return Home</a></h2>
<% end %>
