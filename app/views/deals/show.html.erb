<% if (current_user && current_user.is_admin?) || (current_user && (current_user.project_ids.include? @deal.project_id)) %>
<%- model_class = Deal -%>
<div class="page-header" style="margin: 20px 0 20px;">
  <h1 style="float:left;"><%=t '.title', :default => model_class.model_name.human.titleize %>: <%= @deal.deal_name %></h1>
<% if (current_user && current_user.is_admin?) || (current_user && current_user.role == 'Admin' && (current_user.project_ids.include? @deal.project_id)) || (current_user && current_user.role == 'Editor' && (current_user.project_ids.include? @deal.project_id)) %>

  <%= link_to '+ Associate Area/Deal', new_areas_deal_path(:project_id => @project),
                    :class => 'btn btn-primary print-none',
                    :style => 'float:right;margin-top:20px;margin-right:10px;color:#fff;background-color:#16A3BA;border-color:#16A3BA;' %>
<% end %>
  <br style="clear:both;">
</div>

<dl class="dl-horizontal">
  <dt><strong><%= model_class.human_attribute_name(:deal_name) %>:</strong></dt>
  <dd><%= @deal.deal_name %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:associated_areas) %>:</strong></dt>
  <dd><%= @deal.areas.count %></dd>
  
  <dt><strong><%= model_class.human_attribute_name(:area_titles) %>:</strong></dt>
  <dd>
      <% if @deal.areas.count > 0 %>
        <% @deal.areas.each do |area| %>
          <%= link_to area.suite_number, area %>
          <% if current_user.is_admin? || current_user.role == 'Admin' || current_user.role == 'Editor' %>
          <%= link_to '<i class="fa fa-minus-square"></i>'.html_safe, areas_deal_path(AreasDeal.where(deal_id: @deal, area_id: area).ids), 
              :method => :delete, 
              :title => 'Remove Association',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) } %>
          <% end %>
          <br>
        <% end %>
      <% else %>There are no areas associated.<% end %></dd>
  
  <br>
  <%= render :partial => 'add_area_association' %>
  
  
  <dt><strong><%= model_class.human_attribute_name(:gross_area) %>:</strong></dt>
  <dd><%= number_with_delimiter(@deal.gross_area, :delimiter => ',') %></dd>
  <dt><strong><%= model_class.human_attribute_name(:net_rentable_area) %>:</strong></dt>
  <dd><%= number_with_delimiter(@deal.net_rentable_area, :delimiter => ',') %></dd>
  <dt><strong><%= model_class.human_attribute_name(:lease_status) %>:</strong></dt>
  <dd><%= @deal.lease_status %></dd>
  <dt><strong><%= model_class.human_attribute_name(:project_id) %>:</strong></dt>
  <dd><%= @deal.project_id %></dd>
  <dt><strong><%= model_class.human_attribute_name(:map_id) %>:</strong></dt>
  <dd><%= @deal.map_id %></dd>
</dl>


<div class="row">
  <div class="col-lg-3">
    <% @dealimages.each do |p| %>
          <%= image_tag p.dealimage_url, :style => 'max-width:100%;padding:5%;' %><br>
          
          <div style="margin-left:auto;margin-right:auto;text-align:center;">
          <%= link_to '<i class="fa fa-edit"></i>'.html_safe,
                edit_dealimage_path(p), :class => 'btn btn-primary', 
                :title => 'Edit Attachment'  %>
          <%#= link_to "Destroy Attachment", destroy_associate_attachment_path(p) %>
          <%= link_to '<i class="fa fa-trash"></i>'.html_safe,
                dealimage_path(p),
                :method => 'delete',
                :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                :class => 'btn btn-danger', :title => 'Delete Attachment'  %>
          </div>
          <hr style="clear:both;">
    <% end %>
  </div>
</div>


<%= link_to "<= Project",
              project_path(@deal.project_id), :class => 'btn btn-default'  %>

<% if (current_user && current_user.is_admin?) || (current_user && current_user.role == 'Admin' && (current_user.project_ids.include? @deal.project_id)) || (current_user && current_user.role == 'Editor' && (current_user.project_ids.include? @deal.project_id)) %>
<%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_deal_path(@deal), :class => 'btn btn-primary' %>
<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              deal_path(@deal),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
<% end %>

<% else %>
 <h2>You are not authorized to be here. <a href="/" class="btn btn-default">Return Home</a></h2>
<% end %>
