<% if (current_user && current_user.is_admin?) %>

<h1>Users</h1>

<table class="table table-striped">
  <thead>
    <tr>
      <th>User id:</th>
      <th>Avatar:</th>
      <th>User:</th>
      <th>First Name:</th>
      <th>Last Name:</th>
      <th>Invited By:</th>
      <th>Invited By ID:</th>
      <th>Project ID:</th>
      <td>Project IDs:</td>
      <th>Role:</th>
      <th>Last Signed in at:</th>
      <th>Sign in count:</th>
      
      <th><%=t '.actions', :default => t("helpers.actions") %>:</th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= link_to user.id, user_path(user) %></td>
        <td>
          <% if user.user_avatars.any? %>
          <%= link_to image_tag(user.user_avatars.first.avatar, 
                :style => 'max-width:50px;max-height:50px;padding:2px;'), user_path(user) %>
          <% else %>
          <%= link_to image_tag('/images/NO-IMAGE-AVAILABLE.jpg',
                :style => 'max-width:50px;max-height:50px;padding:2px;'), user_path(user) %>
          <% end %>
        </td>
        <td><%= link_to user.email, user_path(user) %></td>
        <td><%= user.first_name %></td>
        <td><%= user.last_name %></td>
        <td><%= user.invited_by %></td>
        <td><%= user.invited_by_id %></td>
        <td><%= user.project_id %></td>
        <td><%= user.project_ids %></td>
        <td><% if user.is_admin? %>Super-Admin<% elsif user.role.blank? %>User<% else %><%= user.role %><% end %></td>
        <td><%= user.last_sign_in_at %></td>
        <td><%= user.sign_in_count %></td>
        
        <td>
          <%= link_to t('.view', :default => t("helpers.links.view")),
                      user_path(user), :class => 'btn btn-default btn-xs', :style => 'min-width:60px;margin-bottom:2px;' %><br>
          <% if current_user.is_admin? || user.id == current_user.id %>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                                    edit_user_path(user), :class => 'btn btn-primary btn-xs', :style => 'min-width:60px;margin-bottom:2px;' %><br>
          <% end %>
          <% if current_user.is_admin? %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      user_path(user),
                      :method => 'delete',
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-danger btn-xs', :style => 'min-width:60px;margin-bottom:2px;' %> 
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%#= link_to 'Home', root_path, :class => 'btn btn-default' %>
<br><br>

<%#= link_to 'Invitations', new_user_invitation_path %>



<%#= link_to users_path %>
<% else %>
 <h2>You are not authorized to be here. <a href="/" class="btn btn-default">Return Home</a></h2>
<% end %>